<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://cdn.jsdelivr.net/gh/AimiP02/IMG/bitbug_favicon.ico">
  <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/AimiP02/IMG/bitbug_favicon.ico">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="L@in">
  <meta name="keywords" content="">
  <title>模板整理 - L@in</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/atom-one-dark.min.css" />
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 4.2.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>L@in</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('http://ww1.sinaimg.cn/large/005J92LSly1go3farasnjj31p40ww7wh.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2019-01-26 01:06">
      2019年1月26日 凌晨
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7.9k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      152
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <p>预计可能会有：</p>
<p>数论：快速幂，gcd，exgcd，逆元，Lucas定理，CRT，BSGS，欧拉函数，线性筛，矩阵乘法，FFT</p>
<p>图论：最短路，最小生成树，最大流，费用流，有向图的强连通分量，无向图的边的双联通分量</p>
<p>树：LCA，树分治，树链剖分</p>
<p>数据结构：树状数组，线段树，Splay，Treap，LCT，莫队，左偏树</p>
<p>先写一部分吧，反正大多数也不会，会写多少写多少吧…</p>
<a id="more"></a>
<h3 id="数论"><a class="markdownIt-Anchor" href="#数论"></a> 数论</h3>
<h4 id="快速幂"><a class="markdownIt-Anchor" href="#快速幂"></a> 快速幂</h4>
<pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">qpow</span><span class="hljs-params">(ll a, ll n, ll mod)</span></span>&#123;
	ll res=<span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span>(n)&#123;
        <span class="hljs-keyword">if</span>(n&amp;<span class="hljs-number">1</span>) res=(res*a)%mod;
        n&gt;&gt;=<span class="hljs-number">1</span>;
        a=(a*a)%mod;
    &#125;
    <span class="hljs-keyword">return</span> res;
&#125;</code></pre>
<h4 id="gcd"><a class="markdownIt-Anchor" href="#gcd"></a> gcd</h4>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">gcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;
	<span class="hljs-keyword">return</span> b==<span class="hljs-number">0</span>?a:gcd(b,a%b);
&#125;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lcm</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;
    <span class="hljs-keyword">return</span> a*b/gcd(a,b);
&#125;</code></pre>
<h4 id="exgcd"><a class="markdownIt-Anchor" href="#exgcd"></a> exgcd</h4>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">exgcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b,<span class="hljs-keyword">int</span> c,<span class="hljs-keyword">int</span> &amp;x,<span class="hljs-keyword">int</span> &amp;y)</span></span>&#123;
    <span class="hljs-keyword">if</span>(!b)&#123;c=a;x=<span class="hljs-number">1</span>;y=<span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> ;&#125;
    <span class="hljs-keyword">else</span>&#123;exgcd(b,a%b,c,y,x);y-=(a/b)*x;&#125;
&#125;</code></pre>
<h4 id="逆元"><a class="markdownIt-Anchor" href="#逆元"></a> 逆元</h4>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">inv</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> n)</span></span>&#123;
    <span class="hljs-keyword">return</span> qpow(a,n<span class="hljs-number">-2</span>,n);
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">inv</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> n)</span></span>&#123;
    <span class="hljs-keyword">int</span> x, y;
    exgcd(a,n,x,y);
    <span class="hljs-keyword">return</span> (x+n)%n;
&#125;</code></pre>
<h4 id="欧拉函数"><a class="markdownIt-Anchor" href="#欧拉函数"></a> 欧拉函数</h4>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">get_phi</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">memset</span>(not_prime, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(not_prime));
    phi[<span class="hljs-number">1</span>]=<span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i)&#123;
        <span class="hljs-keyword">if</span>(!not_prime[i])&#123;prime[++top]=i;phi[i]=i<span class="hljs-number">-1</span>;&#125;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= top&amp;&amp;i*prime[j] &lt;= n; ++j)&#123;
            not_prime[prime[j]*i]=<span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span>(i%prime[j]==<span class="hljs-number">0</span>)&#123;phi[prime[j]*i]=phi[i]*prime[j];<span class="hljs-keyword">break</span>;&#125;
            phi[prime[j]*i]=phi[i]*(prime[j]<span class="hljs-number">-1</span>);
        &#125;
    &#125;
&#125;</code></pre>
<h4 id="中国剩余定理"><a class="markdownIt-Anchor" href="#中国剩余定理"></a> 中国剩余定理</h4>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">CRT</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a[],<span class="hljs-keyword">int</span> m[],<span class="hljs-keyword">int</span> n)</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-keyword">int</span> M = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>; i&lt;=n; i++)
        M *= m[i];
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>; i&lt;=n; i++)
    &#123;
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-keyword">int</span> Mi = M / m[i];
        exgcd(Mi, m[i], x, y);
        ans = (ans + Mi * x * a[i]) % M;
    &#125;
    <span class="hljs-keyword">if</span>(ans &lt; <span class="hljs-number">0</span>) ans += M;
    <span class="hljs-keyword">return</span> ans;
&#125;</code></pre>
<h4 id="线性筛"><a class="markdownIt-Anchor" href="#线性筛"></a> 线性筛</h4>
<pre><code class="hljs cpp"><span class="hljs-keyword">int</span> prime[max_], primes[max_], num;
<span class="hljs-built_in">memset</span>(prime,<span class="hljs-number">1</span>,<span class="hljs-keyword">sizeof</span>(prime));
prime[<span class="hljs-number">0</span>]=prime[<span class="hljs-number">1</span>]=<span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">2</span>;i&lt;=limit;i++)
&#123;
	<span class="hljs-keyword">if</span>(prime[i])primes[num++]=i;
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;num&amp;&amp;i*primes[j]&lt;limit;j++)
	&#123;
		prime[i*primes[j]]=<span class="hljs-number">0</span>;
		<span class="hljs-keyword">if</span>(!(i%primes[j]))<span class="hljs-keyword">break</span>;
	&#125;
&#125;</code></pre>
<h4 id="矩阵乘法"><a class="markdownIt-Anchor" href="#矩阵乘法"></a> 矩阵乘法</h4>
<pre><code class="hljs cpp"><span class="hljs-comment">//顺便带了一个快速幂，递推数列的矩阵自己推</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> Mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Mat</span>&#123;</span>
    ll m[<span class="hljs-number">110</span>][<span class="hljs-number">110</span>];
&#125;;

ll n, k;
Mat input, unit;

<span class="hljs-function">Mat <span class="hljs-title">Matrix_Mul</span><span class="hljs-params">(Mat x, Mat y)</span> </span>&#123;
    Mat c;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;
            c.m[i][j] = <span class="hljs-number">0</span>;
        &#125;
    &#125;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; k++) &#123;
                c.m[i][j] = c.m[i][j] % Mod + x.m[i][k] * y.m[k][j] % Mod;
            &#125;
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> c;
&#125;
<span class="hljs-function">Mat <span class="hljs-title">Quick_Matrix_pow</span><span class="hljs-params">(Mat a, ll n)</span> </span>&#123;
    Mat res = unit;
    <span class="hljs-keyword">while</span> (n) &#123;
        <span class="hljs-keyword">if</span> (n &amp; <span class="hljs-number">1</span>)
            res = Matrix_Mul(res, a);
        a = Matrix_Mul(a, a);
        n &gt;&gt;= <span class="hljs-number">1</span>;
    &#125;
    <span class="hljs-keyword">return</span> res;
&#125;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%lld %lld"</span>, &amp;n, &amp;k);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;
            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%lld"</span>, &amp;input.m[i][j]);
        &#125;
    &#125;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)
        unit.m[i][i] = <span class="hljs-number">1</span>;
    Mat ans = Quick_Matrix_pow(input, k);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld "</span>, ans.m[i][j] % Mod);
        &#125;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h4 id="lucas定理"><a class="markdownIt-Anchor" href="#lucas定理"></a> Lucas定理</h4>
<p>用不熟练还是不写了</p>
<h4 id="bsgs"><a class="markdownIt-Anchor" href="#bsgs"></a> BSGS</h4>
<p>只听过</p>
<h4 id="fft"><a class="markdownIt-Anchor" href="#fft"></a> FFT</h4>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstdlib&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cmath&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;ctime&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cassert&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;climits&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;string&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;deque&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;list&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;set&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;map&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stack&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;queue&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;numeric&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iomanip&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bitset&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;sstream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;fstream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> debug puts(<span class="hljs-meta-string">"-----"</span>)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rep(i,l,r) for(register int i=l;i&lt;=r;++i)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dep(i,r,l) for(register int i=r;i&gt;=l;--i)</span>

<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ull;
<span class="hljs-keyword">template</span> &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt; <span class="hljs-title">T</span> <span class="hljs-title">chkmax</span>(<span class="hljs-title">T</span> <span class="hljs-title">a</span>, <span class="hljs-title">T</span> <span class="hljs-title">b</span>) &#123;</span><span class="hljs-keyword">return</span> a &gt; b ? a : b;&#125;
<span class="hljs-keyword">template</span> &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt; <span class="hljs-title">T</span> <span class="hljs-title">chkmin</span>(<span class="hljs-title">T</span> <span class="hljs-title">a</span>, <span class="hljs-title">T</span> <span class="hljs-title">b</span>) &#123;</span><span class="hljs-keyword">return</span> a &gt; b ? b : a;&#125;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> Maxn = <span class="hljs-number">2e6</span> + <span class="hljs-number">7</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> INF = <span class="hljs-number">2147483647</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> mod = <span class="hljs-number">19260817</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">double</span> pi = <span class="hljs-built_in">acos</span>(<span class="hljs-number">-1.0</span>);

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">read</span><span class="hljs-params">()</span> </span>&#123;
	<span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> g = <span class="hljs-number">1</span>; <span class="hljs-keyword">register</span> <span class="hljs-keyword">char</span> ch;
	<span class="hljs-keyword">while</span>(!<span class="hljs-built_in">isdigit</span>(ch = getchar())) <span class="hljs-keyword">if</span>(ch == <span class="hljs-string">'-'</span>) g = <span class="hljs-number">-1</span>;
	<span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> x = ch ^ <span class="hljs-string">'0'</span>;
	<span class="hljs-keyword">while</span>(<span class="hljs-built_in">isdigit</span>(ch = getchar())) x = x * <span class="hljs-number">10</span> + (ch ^ <span class="hljs-string">'0'</span>);
	<span class="hljs-keyword">return</span> x * g;	
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;
	<span class="hljs-keyword">if</span>(x &lt; <span class="hljs-number">0</span>) <span class="hljs-built_in">putchar</span>(<span class="hljs-string">'-'</span>), x = -x;
	<span class="hljs-keyword">if</span>(x &gt; <span class="hljs-number">9</span>) print(x / <span class="hljs-number">10</span>);
	<span class="hljs-built_in">putchar</span>(x % <span class="hljs-number">10</span> + <span class="hljs-string">'0'</span>);	
&#125;

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Complex</span>&#123;</span>
    <span class="hljs-keyword">double</span> a, b;
    Complex() &#123;&#125;
    Complex(<span class="hljs-keyword">double</span> _a, <span class="hljs-keyword">double</span> _b) : a(_a), b(_b) &#123;&#125;
    Complex(<span class="hljs-keyword">double</span> _a) : a(_a), b(<span class="hljs-number">0.0</span>) &#123;&#125;
    <span class="hljs-keyword">inline</span> Complex <span class="hljs-keyword">operator</span> + (<span class="hljs-keyword">const</span> Complex &amp;z) <span class="hljs-keyword">const</span> &#123;
        <span class="hljs-keyword">return</span> Complex(a + z.a, b + z.b);
    &#125;
    <span class="hljs-keyword">inline</span> Complex <span class="hljs-keyword">operator</span> - (<span class="hljs-keyword">const</span> Complex &amp;z) <span class="hljs-keyword">const</span> &#123;
        <span class="hljs-keyword">return</span> Complex(a - z.a, b - z.b);	
    &#125;
    <span class="hljs-keyword">inline</span> Complex <span class="hljs-keyword">operator</span> * (<span class="hljs-keyword">const</span> Complex &amp;z) <span class="hljs-keyword">const</span> &#123;
        <span class="hljs-keyword">return</span> Complex(a * z.a - b * z.b, a * z.b + b * z.a);
    &#125;
    <span class="hljs-keyword">inline</span> Complex <span class="hljs-keyword">operator</span> / (<span class="hljs-keyword">const</span> Complex &amp;z) <span class="hljs-keyword">const</span> &#123;
        <span class="hljs-keyword">double</span> m = z.a * z.a + z.b * z.b;
        <span class="hljs-keyword">return</span> Complex((a * z.a + b * z.b) / m, (b * z.a - a * z.b) / m);	
    &#125;
&#125;;

Complex a[Maxn], b[Maxn];
<span class="hljs-keyword">int</span> alen, blen, len, L, n, rev[Maxn], ans[Maxn];
<span class="hljs-keyword">int</span> _a[Maxn], _b[Maxn];

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">FFT</span><span class="hljs-params">(Complex c[], <span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> f)</span> </span>&#123;
    Complex wn, w, x, y;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i)
        <span class="hljs-keyword">if</span>(i &lt; rev[i]) <span class="hljs-built_in">std</span>::swap(c[i], c[rev[i]]);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; i &lt;&lt;= <span class="hljs-number">1</span>) &#123;
        wn = Complex(<span class="hljs-built_in">cos</span>(pi / i), <span class="hljs-built_in">sin</span>(pi / i) * f);
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> p = i &lt;&lt; <span class="hljs-number">1</span>, j = <span class="hljs-number">0</span>; j &lt; n; j += p) &#123;
            w = Complex(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; i; ++k, w = w * wn) &#123;
                x = c[j + k]; y = w * c[j + k + i];
                c[j + k] = x + y; c[j + k + i] = x - y;
            &#125;
        &#125;
    &#125;
    <span class="hljs-keyword">if</span>(!~f) <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) c[i].a /= (<span class="hljs-keyword">double</span>)n;
    <span class="hljs-keyword">return</span> ;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;
    alen = read(), blen = read(), len = alen + blen;
    <span class="hljs-keyword">for</span>(n = <span class="hljs-number">1</span>; n &lt;= len; n &lt;&lt;= <span class="hljs-number">1</span>, L++);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) rev[i] = (rev[i &gt;&gt; <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">1</span>) | ((i &amp; <span class="hljs-number">1</span>) &lt;&lt; (L - <span class="hljs-number">1</span>));
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= alen; ++i) a[i].a = read();
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= blen; ++i) b[i].a = read();
    FFT(a, n, <span class="hljs-number">1</span>); FFT(b, n, <span class="hljs-number">1</span>);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= n; ++i) a[i] = a[i] * b[i];
    FFT(a, n, <span class="hljs-number">-1</span>);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= len; ++i) ans[i] = (<span class="hljs-keyword">int</span>)(a[i].a + <span class="hljs-number">0.5</span>);
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= len; ++i) <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d "</span>, ans[i]);
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="图论"><a class="markdownIt-Anchor" href="#图论"></a> 图论</h3>
<h4 id="最短路"><a class="markdownIt-Anchor" href="#最短路"></a> 最短路</h4>
<h5 id="dijkstra"><a class="markdownIt-Anchor" href="#dijkstra"></a> Dijkstra</h5>
<pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> N 200010</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INF 1 &lt;&lt; 30</span>

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">EdGe</span></span>
<span class="hljs-class">&#123;</span>
    <span class="hljs-keyword">int</span> next, to, val;	
&#125;edge[N * <span class="hljs-number">2</span>];

<span class="hljs-keyword">int</span> last[N * <span class="hljs-number">2</span>], cnt, dis[N];
<span class="hljs-keyword">bool</span> vis[N];

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">heapnode</span></span>
<span class="hljs-class">&#123;</span>
    <span class="hljs-keyword">int</span> node,val;
    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span> &lt; (<span class="hljs-keyword">const</span> heapnode &amp;rhs) <span class="hljs-keyword">const</span> 
    &#123;
        <span class="hljs-keyword">return</span> val &gt; rhs.val;
    &#125;
&#125;;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addedge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> v, <span class="hljs-keyword">int</span> w)</span></span>
<span class="hljs-function"></span>&#123;
    edge[++cnt].next = last[u];
    edge[cnt].to = v;
    edge[cnt].val = w;
    last[u] = cnt;
&#125;

<span class="hljs-keyword">int</span> n, m, s;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">(<span class="hljs-keyword">int</span> s)</span></span>
<span class="hljs-function"></span>&#123;	
    <span class="hljs-built_in">std</span>::priority_queue&lt;heapnode&gt; Q;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)
    &#123;
        dis[i] = INF;
        vis[i] = <span class="hljs-number">0</span>;
    &#125;
    dis[s] = <span class="hljs-number">0</span>;
    Q.push((heapnode)&#123;s,<span class="hljs-number">0</span>&#125;);
    <span class="hljs-keyword">while</span> (!Q.empty())
    &#123;
        heapnode U = Q.top();
        Q.pop();
        <span class="hljs-keyword">if</span> (vis[U.node])
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">int</span> u = U.node;
        vis[u] = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = last[u]; i; i = edge[i].next)
        &#123;
            <span class="hljs-keyword">int</span> v = edge[i].to;
            <span class="hljs-keyword">if</span> (dis[v] &gt; dis[u] + edge[i].val)
            &#123;
                dis[v] = dis[u] + edge[i].val;
                Q.push((heapnode)&#123;v,dis[v]&#125;);
            &#125;
        &#125;
    &#125;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;s);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++)
    &#123;
        <span class="hljs-keyword">int</span> x, y, z;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;x, &amp;y, &amp;z);
        addedge(x, y, z);
        addedge(y, x, z);
    &#125;
    dijkstra(s);
    <span class="hljs-comment">///do something...</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h5 id="spfaslf"><a class="markdownIt-Anchor" href="#spfaslf"></a> SPFA///slf</h5>
<pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> N 200010</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INF 1 &lt;&lt; 30</span>

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">EdGe</span></span>
<span class="hljs-class">&#123;</span>
    <span class="hljs-keyword">int</span> next, to, val;	
&#125;edge[N * <span class="hljs-number">2</span>];

<span class="hljs-keyword">int</span> last[N * <span class="hljs-number">2</span>], cnt, dis[N];
<span class="hljs-keyword">bool</span> vis[N];

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addedge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> v, <span class="hljs-keyword">int</span> w)</span></span>
<span class="hljs-function"></span>&#123;
    edge[++cnt].next = last[u];
    edge[cnt].to = v;
    edge[cnt].val = w;
    last[u] = cnt;
&#125;

<span class="hljs-keyword">int</span> n, m, s;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">spfa</span><span class="hljs-params">(<span class="hljs-keyword">int</span> s)</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">deque</span>&lt;<span class="hljs-keyword">int</span>&gt; Q;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= P; i++)
    &#123;
        dis[i] = INF;
        vis[i] = <span class="hljs-number">0</span>;
    &#125;
    Q.push_back(s);
    dis[s] = <span class="hljs-number">0</span>;
    vis[s] = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (!Q.empty())
    &#123;
        <span class="hljs-keyword">int</span> u = Q.front();
        Q.pop_front();
        vis[u] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = last[u]; i; i = edge[i].next)
        &#123;
            <span class="hljs-keyword">int</span> v = edge[i].to;
            <span class="hljs-keyword">if</span> (dis[v] &gt; dis[u] + edge[i].val)
            &#123;
                dis[v] = dis[u] + edge[i].val;
                <span class="hljs-keyword">if</span> (!vis[v])
                &#123;
                    vis[v] = <span class="hljs-number">1</span>;
                    <span class="hljs-keyword">if</span>(!q.empty()&amp;&amp;dis[to]&lt;dis[q.front()]) q.push_front(to);
                    <span class="hljs-keyword">else</span> q.push_back(to);
                    <span class="hljs-comment">//忘了是不是这么写了...</span>
                &#125;
            &#125;
        &#125;
    &#125;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;s);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= C; i++)
    &#123;
        <span class="hljs-keyword">int</span> x, y, z;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;x, &amp;y, &amp;z);
        addedge(x, y, z);
        addedge(y, x, z);
    &#125;
    spfa(s);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h4 id="最小生成树"><a class="markdownIt-Anchor" href="#最小生成树"></a> 最小生成树</h4>
<h5 id="kruskal"><a class="markdownIt-Anchor" href="#kruskal"></a> Kruskal</h5>
<pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span>&#123;</span>
	<span class="hljs-keyword">int</span> next, to, val;
&#125;e[max_&lt;&lt;<span class="hljs-number">1</span>];

<span class="hljs-keyword">int</span> F[max_];
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;
	<span class="hljs-keyword">return</span> x==F[x]?x:F[x]=find(F[x]);
&#125;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span></span>&#123;
	F[find(b)]=find(a);
&#125;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(edge a, edge b)</span></span>&#123;
	<span class="hljs-keyword">return</span> a.val&lt;b.val;
&#125;
<span class="hljs-keyword">int</span> ans=<span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">kruskal</span><span class="hljs-params">()</span></span>&#123;
	<span class="hljs-keyword">int</span> k=<span class="hljs-number">0</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;++i) F[i]=i;
	sort(e+<span class="hljs-number">1</span>,e+m+<span class="hljs-number">1</span>,cmp);
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;++i)&#123;
		<span class="hljs-keyword">int</span> u=e[i].next;
		<span class="hljs-keyword">int</span> v=e[i].to;
		<span class="hljs-keyword">if</span>(find(u)!=find(v))&#123;
			merge(u,v);
			ans+=e[i].val;k++;
			<span class="hljs-keyword">if</span>(k==n<span class="hljs-number">-1</span>) <span class="hljs-keyword">break</span>;
		&#125;
	&#125;
&#125;</code></pre>
<h5 id="prim"><a class="markdownIt-Anchor" href="#prim"></a> Prim</h5>
<p>先占坑，不会写</p>
<h4 id="网络流"><a class="markdownIt-Anchor" href="#网络流"></a> 网络流</h4>
<h5 id="dinic"><a class="markdownIt-Anchor" href="#dinic"></a> Dinic</h5>
<pre><code class="hljs cpp"><span class="hljs-keyword">int</span> n, m, s, t;
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span>&#123;</span>
	<span class="hljs-keyword">int</span> next, to, val;
&#125;e[max_&lt;&lt;<span class="hljs-number">1</span>];
<span class="hljs-keyword">int</span> head[max_], cnt=<span class="hljs-number">1</span>, cur[max_], depth[max_];

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u,<span class="hljs-keyword">int</span> v,<span class="hljs-keyword">int</span> w)</span></span>&#123;e[++cnt].next=head[u];e[cnt].to=v;e[cnt].flow=w;head[u]=cnt;&#125;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ins</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u,<span class="hljs-keyword">int</span> v,<span class="hljs-keyword">int</span> w)</span></span>&#123;add(u,v,w);add(v,u,<span class="hljs-number">0</span>);&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">memset</span>(depth, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span>(depth));
    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt; q;
    q.push(s), depth[s]=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span>(!q.empty())&#123;
    	<span class="hljs-keyword">int</span> now=q.front();q.pop();
    	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=head[now];i;i=e[i].next)&#123;
    		<span class="hljs-keyword">int</span> to=e[i].to;
    		<span class="hljs-keyword">if</span>(depth[to]==<span class="hljs-number">-1</span>&amp;&amp;e[i].flow)&#123;
    			depth[to]=depth[now]+<span class="hljs-number">1</span>;q.push(to);
    		&#125;
    	&#125;
    &#125;
    <span class="hljs-keyword">return</span> depth[t]!=<span class="hljs-number">-1</span>;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> now, <span class="hljs-keyword">int</span> limit)</span></span>&#123;
	<span class="hljs-keyword">if</span>(now==t) <span class="hljs-keyword">return</span> limit;
	<span class="hljs-keyword">int</span> w, flow=<span class="hljs-number">0</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span>&amp; i=cur[now];i;i=e[i].next)&#123;
		<span class="hljs-keyword">int</span> to=e[i].to;
		<span class="hljs-keyword">if</span>(depth[to]==depth[now]+<span class="hljs-number">1</span>&amp;&amp;e[i].flow)&#123;
			w=dfs(to, min(limit-flow, e[i].flow));
			e[i].flow-=w;
			e[i^<span class="hljs-number">1</span>].flow+=w;
			flow+=w;
			<span class="hljs-keyword">if</span>(flow==limit) <span class="hljs-keyword">return</span> flow;
		&#125;
	&#125;
	<span class="hljs-keyword">if</span>(!flow) depth[now]=<span class="hljs-number">-1</span>;
	<span class="hljs-keyword">return</span> flow;
&#125;

<span class="hljs-keyword">int</span> maxflow=<span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dinic</span><span class="hljs-params">()</span></span>&#123;
	<span class="hljs-keyword">while</span>(bfs())&#123;
		<span class="hljs-built_in">memcpy</span>(cur, head, <span class="hljs-keyword">sizeof</span>(head));
		maxflow+=dfs(s, inf);
	&#125;
&#125;</code></pre>
<h5 id="zkw费用流不想写一般的费用流了"><a class="markdownIt-Anchor" href="#zkw费用流不想写一般的费用流了"></a> zkw费用流//不想写一般的费用流了</h5>
<pre><code class="hljs cpp"><span class="hljs-keyword">int</span> n, m, s, t;
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span>&#123;</span>
	<span class="hljs-keyword">int</span> next, to, flow, dis;
&#125;e[max_&lt;&lt;<span class="hljs-number">1</span>];
<span class="hljs-keyword">int</span> head[max_], cnt=<span class="hljs-number">1</span>, depth[max_], cur[max_], dis[max_], vis[max_];

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u,<span class="hljs-keyword">int</span> v,<span class="hljs-keyword">int</span> w,<span class="hljs-keyword">int</span> c)</span></span>&#123;
	e[++cnt].next=head[u];e[cnt].to=v;e[cnt].flow=w;e[cnt].dis=c;head[u]=cnt;
&#125;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ins</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u,<span class="hljs-keyword">int</span> v,<span class="hljs-keyword">int</span> w, <span class="hljs-keyword">int</span> c)</span></span>&#123;
	ins(u,v,w,c);ins(v,u,<span class="hljs-number">0</span>,-c);
&#125;

<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">spfa</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">memset</span>(vis, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(vis));
    <span class="hljs-built_in">memset</span>(dis, <span class="hljs-number">0x7f</span>, <span class="hljs-keyword">sizeof</span>(dis));
    <span class="hljs-built_in">deque</span>&lt;<span class="hljs-keyword">int</span>&gt; q;
    q.push_back(t), dis[t]=<span class="hljs-number">0</span>, vis[t]=<span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span>(!q.empty())&#123;
        <span class="hljs-keyword">int</span> now=q.front();q.pop_front();vis[now]=<span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=head[now];i;i=e[i].next)&#123;
            <span class="hljs-keyword">int</span> to=e[i].to;
            <span class="hljs-keyword">if</span>(e[i^<span class="hljs-number">1</span>].flow&amp;&amp;dis[to]&gt;dis[now]-e[i].dis)&#123;
                dis[to]=dis[now]-e[i].dis;
                <span class="hljs-keyword">if</span>(!vis[to])&#123;
                    vis[to]=<span class="hljs-number">1</span>;
                    <span class="hljs-keyword">if</span>(!q.empty()&amp;&amp;dis[to]&lt;dis[q.front()]) q.push_front(to);
                    <span class="hljs-keyword">else</span> q.push_back(to);
                &#125;
            &#125;
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> dis[s]&lt;inf;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> now, <span class="hljs-keyword">int</span> limit)</span></span>&#123;
    <span class="hljs-keyword">if</span>(now==t)&#123;
        vis[now]=<span class="hljs-number">1</span>;<span class="hljs-keyword">return</span> limit;
    &#125;
    <span class="hljs-keyword">int</span> w, flow=<span class="hljs-number">0</span>;
    vis[now]=<span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span>&amp; i=cur[now];i;i=e[i].next)&#123;
        <span class="hljs-keyword">int</span> to=e[i].to;
        <span class="hljs-keyword">if</span>(!vis[to]&amp;&amp;e[i].flow&amp;&amp;dis[now]-e[i].dis==dis[to])&#123;
            w=dfs(to,min(e[i].flow,limit-flow));
            <span class="hljs-keyword">if</span>(w)&#123;
                ans+=w*e[i].dis;e[i].flow-=w;e[i^<span class="hljs-number">1</span>].flow+=w;flow+=w;
            &#125;
            <span class="hljs-keyword">if</span>(flow==limit) <span class="hljs-keyword">break</span>;
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> flow;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mcf</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-keyword">int</span> flow=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span>(spfa())&#123;
        vis[t]=<span class="hljs-number">1</span>;
        <span class="hljs-keyword">while</span>(vis[t])&#123;
            <span class="hljs-built_in">memset</span>(vis, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(vis));
            <span class="hljs-built_in">memcpy</span>(cur, head, <span class="hljs-keyword">sizeof</span>(head));
            flow+=dfs(s, inf);
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> flow;
&#125;</code></pre>
<h4 id="强连通分量"><a class="markdownIt-Anchor" href="#强连通分量"></a> 强连通分量</h4>
<h5 id="割点"><a class="markdownIt-Anchor" href="#割点"></a> 割点</h5>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">300010</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> inf = <span class="hljs-number">0x7f7f7f7f</span>;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">read</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">register</span> <span class="hljs-keyword">char</span> ch;
    <span class="hljs-keyword">while</span>(!<span class="hljs-built_in">isdigit</span>(ch = getchar()));
    <span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> x = ch ^ <span class="hljs-string">'0'</span>;
    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">isdigit</span>(ch = getchar())) x = (((x &lt;&lt; <span class="hljs-number">2</span>) + x) &lt;&lt; <span class="hljs-number">1</span>) + (ch ^ <span class="hljs-string">'0'</span>);
    <span class="hljs-keyword">return</span> x;
&#125;

<span class="hljs-keyword">int</span> n, m;
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span>&#123;</span>
    <span class="hljs-keyword">int</span> next, to;
&#125;e[maxn&lt;&lt;<span class="hljs-number">1</span>];
<span class="hljs-keyword">int</span> head[maxn], cnt = <span class="hljs-number">0</span>;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> v)</span> </span>&#123;e[++cnt] = (edge)&#123;head[u], v&#125;; head[u] = cnt;&#125;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ins</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> v)</span> </span>&#123;add(u, v); add(v, u);&#125;

<span class="hljs-keyword">int</span> low[maxn], dfn[maxn], idx = <span class="hljs-number">0</span>, cut[maxn], point = <span class="hljs-number">0</span>;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-keyword">int</span> now, <span class="hljs-keyword">int</span> fa)</span> </span>&#123;
    low[now] = dfn[now] = ++idx;
    <span class="hljs-keyword">int</span> child = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> i = head[now]; i; i = e[i].next) &#123;
        <span class="hljs-keyword">int</span> to = e[i].to;
        <span class="hljs-keyword">if</span>(!dfn[to]) &#123;
            tarjan(to, fa);
            low[now] = <span class="hljs-built_in">std</span>::min(low[now], low[to]);
            <span class="hljs-keyword">if</span>(low[to] &gt;= dfn[now] &amp;&amp; now != fa)
                cut[now] = <span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span>(now == fa) ++child;
        &#125;
        low[now] = <span class="hljs-built_in">std</span>::min(low[now], dfn[to]);
    &#125;
    <span class="hljs-keyword">if</span>(child &gt;= <span class="hljs-number">2</span> &amp;&amp; now == fa) cut[now] = <span class="hljs-number">1</span>;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;
    n = read(), m = read();
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; ++i) &#123;
        <span class="hljs-keyword">int</span> x = read(), y = read();
        ins(x, y);
    &#125;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) 
        <span class="hljs-keyword">if</span>(!dfn[i]) tarjan(i, i);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)
        <span class="hljs-keyword">if</span>(cut[i]) ++point;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, point);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)
        <span class="hljs-keyword">if</span>(cut[i]) <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d "</span>, i);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="树"><a class="markdownIt-Anchor" href="#树"></a> 树</h3>
<h4 id="lca"><a class="markdownIt-Anchor" href="#lca"></a> LCA</h4>
<p>//不想自己打了…</p>
<h5 id="倍增"><a class="markdownIt-Anchor" href="#倍增"></a> 倍增</h5>
<pre><code class="hljs cpp"><span class="hljs-keyword">int</span> lgn, dep[maxn], anc[maxn][<span class="hljs-number">30</span>];
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = head[u]; i; i = e[i].next) &#123;
        <span class="hljs-keyword">int</span> v = e[i].to;
        <span class="hljs-keyword">if</span>(v == anc[u][<span class="hljs-number">0</span>]) <span class="hljs-keyword">continue</span>;
        anc[v][<span class="hljs-number">0</span>] = u;
        dep[v] = dep[u] + <span class="hljs-number">1</span>;
        dfs(v);
    &#125;
&#125;
 
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">calanc</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; (<span class="hljs-number">1</span> &lt;&lt; j) &lt;= sz; j++) &#123;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= sz; i++) &#123;
            anc[i][j] = anc[anc[i][j - <span class="hljs-number">1</span>]][j - <span class="hljs-number">1</span>];
        &#125;
    &#125;
&#125;
 
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">querylca</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> v)</span> </span>&#123;
    <span class="hljs-keyword">if</span>(dep[u] &gt; dep[v]) <span class="hljs-built_in">std</span>::swap(u, v);
    <span class="hljs-keyword">int</span> del = dep[v] - dep[u];
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; (<span class="hljs-number">1</span> &lt;&lt; i) &lt;= del; i++) &#123;
        <span class="hljs-keyword">if</span>((<span class="hljs-number">1</span> &lt;&lt; i) &amp; del) v = anc[v][i];
    &#125;
    <span class="hljs-keyword">if</span>(u == v) <span class="hljs-keyword">return</span> u;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = lgn; i &gt;= <span class="hljs-number">0</span>; i--) &#123;
        <span class="hljs-keyword">if</span>(anc[u][i] != anc[v][i]) &#123;
            u = anc[u][i];
            v = anc[v][i];
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> anc[u][<span class="hljs-number">0</span>];
&#125;</code></pre>
<h5 id="st表"><a class="markdownIt-Anchor" href="#st表"></a> ST表</h5>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> GCC optimize(3)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> N 500010</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Edge</span></span>
<span class="hljs-class">&#123;</span>
    <span class="hljs-keyword">int</span> next, to;
&#125;edge[N * <span class="hljs-number">2</span>];

<span class="hljs-keyword">int</span> n, m, s, cnt = <span class="hljs-number">0</span>;
<span class="hljs-keyword">int</span> num = <span class="hljs-number">0</span>, cnt_ = <span class="hljs-number">0</span>;
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Tree</span></span>
<span class="hljs-class">&#123;</span>
    <span class="hljs-keyword">int</span> last[N];
    <span class="hljs-keyword">int</span> depth[N];<span class="hljs-comment">//深度 </span>
    <span class="hljs-keyword">bool</span> vis[N];
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> v)</span></span>
<span class="hljs-function">    </span>&#123;
        edge[++cnt].next = last[u];
        edge[cnt].to = v;
        last[u] = cnt; 
    &#125;   
&#125; tree;

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">RMQ</span></span>
<span class="hljs-class">&#123;</span>
    <span class="hljs-keyword">int</span> F[N], dp[N][<span class="hljs-number">21</span>], eu[N];<span class="hljs-comment">// </span>
&#125; rmq;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> fa)</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-keyword">int</span> tmp = ++num;
    rmq.eu[++cnt_] = tmp;
    rmq.F[tmp] = u;
    tree.depth[u] = cnt_;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = tree.last[u]; i; i = edge[i].next)
    &#123;
        <span class="hljs-keyword">int</span> v = edge[i].to;
        <span class="hljs-keyword">if</span> (v == fa)
            <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">else</span>
        &#123;
            tree.vis[v] = <span class="hljs-number">1</span>;
            dfs(v, u);
            rmq.eu[++cnt_] = tmp;
        &#125; 
    &#125;
&#125;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">rmq_st</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)
        rmq.dp[i][<span class="hljs-number">0</span>] = rmq.eu[i];
    <span class="hljs-keyword">int</span> m = (<span class="hljs-keyword">int</span>) (<span class="hljs-built_in">log</span>(<span class="hljs-number">1.0</span> * n) / <span class="hljs-built_in">log</span>(<span class="hljs-number">2.0</span>));
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j++)
    &#123;
        <span class="hljs-keyword">int</span> k = n - (<span class="hljs-number">1</span> &lt;&lt; j) + <span class="hljs-number">1</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= k; i++)
        &#123;
            rmq.dp[i][j] = <span class="hljs-built_in">std</span>::min(rmq.dp[i][j - <span class="hljs-number">1</span>], rmq.dp[i + (<span class="hljs-number">1</span> &lt;&lt; (j - <span class="hljs-number">1</span>))][j - <span class="hljs-number">1</span>]);
        &#125;
    &#125;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">rmq_find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-keyword">int</span> k = (<span class="hljs-keyword">int</span>) (<span class="hljs-built_in">log</span>(<span class="hljs-number">1.0</span> * (r - l) + <span class="hljs-number">1</span>) / <span class="hljs-built_in">log</span>(<span class="hljs-number">2.0</span>));
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::min(rmq.dp[l][k] , rmq.dp[r - (<span class="hljs-number">1</span> &lt;&lt; k) + <span class="hljs-number">1</span>][k]);
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lca</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-keyword">if</span> (tree.depth[x] &gt; tree.depth[y])
        <span class="hljs-built_in">std</span>::swap(x, y);
    <span class="hljs-keyword">int</span> k = rmq_find(tree.depth[x], tree.depth[y]);
    <span class="hljs-keyword">return</span> rmq.F[k];
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;s);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>, x, y; i &lt;= n - <span class="hljs-number">1</span>; i++)
    &#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;x, &amp;y);
        tree.add(x, y);
        tree.add(y, x);
    &#125;
    dfs(s, <span class="hljs-number">0</span>);
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">query</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>, x, y; i &lt;= m; i++)
    &#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;x, &amp;y);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, lca(x, y));
    &#125;   
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
    init();
    rmq_st(cnt_);
    query();
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h4 id="树分治"><a class="markdownIt-Anchor" href="#树分治"></a> 树分治</h4>
<p>不会</p>
<h4 id="树链剖分"><a class="markdownIt-Anchor" href="#树链剖分"></a> 树链剖分</h4>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rep(i,l,r) for(register int i=l;i&lt;=r;++i)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dep(i,r,l) for(register int i=r;i&gt;=l;--i)</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">200010</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> inf = <span class="hljs-number">0x7f7f7f7f</span>;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">read</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-keyword">register</span> <span class="hljs-keyword">char</span> ch;
    <span class="hljs-keyword">while</span>(!<span class="hljs-built_in">isdigit</span>(ch=getchar()));
    <span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> x=ch^<span class="hljs-string">'0'</span>;
    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">isdigit</span>(ch=getchar())) x=(((x&lt;&lt;<span class="hljs-number">2</span>)+x)&lt;&lt;<span class="hljs-number">1</span>)+(ch^<span class="hljs-string">'0'</span>);
    <span class="hljs-keyword">return</span> x;
&#125;

<span class="hljs-keyword">int</span> n, m, r, p;
<span class="hljs-keyword">int</span> a[maxn], b[maxn], size=<span class="hljs-number">0</span>;

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Edge</span>&#123;</span>
    <span class="hljs-keyword">int</span> next, to, val;
&#125;e[maxn];
<span class="hljs-keyword">int</span> head[maxn], cnt=<span class="hljs-number">0</span>;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u,<span class="hljs-keyword">int</span> v)</span></span>&#123;e[++cnt]=(Edge)&#123;head[u],v&#125;;head[u]=cnt;&#125;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ins</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u,<span class="hljs-keyword">int</span> v)</span></span>&#123;add(u,v);add(v,u);&#125;

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SegMent</span>&#123;</span>
    <span class="hljs-keyword">int</span> l, r, sum, tags, sz;
&#125;tr[maxn];

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Sub_Tree</span>&#123;</span>
    <span class="hljs-keyword">int</span> dep[maxn], fa[maxn], son[maxn], tot[maxn];
    <span class="hljs-keyword">int</span> top[maxn], idx[maxn];
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">dfs1</span><span class="hljs-params">(<span class="hljs-keyword">int</span> now, <span class="hljs-keyword">int</span> f, <span class="hljs-keyword">int</span> depth)</span></span>&#123;
        dep[now]=depth;
        fa[now]=f;
        tot[now]=<span class="hljs-number">1</span>;
        <span class="hljs-keyword">int</span> maxson=<span class="hljs-number">-1</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=head[now];i;i=e[i].next)&#123;
            <span class="hljs-keyword">int</span> to=e[i].to;
            <span class="hljs-keyword">if</span>(to==f) <span class="hljs-keyword">continue</span>;
            tot[now]+=dfs1(to,now,depth+<span class="hljs-number">1</span>);
            <span class="hljs-keyword">if</span>(tot[to]&gt;maxson) maxson=tot[to], son[now]=to;
        &#125;
        <span class="hljs-keyword">return</span> tot[now];
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> now, <span class="hljs-keyword">int</span> top_node)</span></span>&#123;
        idx[now]=++size;
        a[size]=b[now];
        top[now]=top_node;
        <span class="hljs-keyword">if</span>(!son[now]) <span class="hljs-keyword">return</span>;
        dfs2(son[now],top_node);
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=head[now];i;i=e[i].next)&#123;
            <span class="hljs-keyword">int</span> to=e[i].to;
            <span class="hljs-keyword">if</span>(!idx[to])
                dfs2(to,to);
        &#125;
    &#125;
&#125;sub;

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SegMent_Tree</span>&#123;</span>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> lson o&lt;&lt;1</span>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rson o&lt;&lt;1|1</span>
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push_up</span><span class="hljs-params">(<span class="hljs-keyword">int</span> o)</span></span>&#123;tr[o].sum=(tr[lson].sum+tr[rson].sum+p)%p;&#125;
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push_down</span><span class="hljs-params">(<span class="hljs-keyword">int</span> o)</span></span>&#123;
        <span class="hljs-keyword">if</span>(tr[o].tags)&#123;
            tr[lson].tags=(tr[lson].tags+tr[o].tags)%p;
            tr[rson].tags=(tr[rson].tags+tr[o].tags)%p;
            tr[lson].sum=(tr[lson].sum+tr[lson].sz*tr[o].tags)%p;
            tr[rson].sum=(tr[rson].sum+tr[rson].sz*tr[o].tags)%p;
            tr[o].tags=<span class="hljs-number">0</span>;
        &#125;
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span> o, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span></span>&#123;
        tr[o].l=l,tr[o].r=r,tr[o].sz=r-l+<span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span>(l==r)&#123;
            tr[o].sum=a[l];
            <span class="hljs-keyword">return</span> ;
        &#125;
        <span class="hljs-keyword">int</span> mid=(l+r)&gt;&gt;<span class="hljs-number">1</span>;
        build(lson,l,mid); build(rson,mid+<span class="hljs-number">1</span>,r);
        push_up(o);
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update_add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> o, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> v)</span></span>&#123;
        <span class="hljs-keyword">if</span>(l&lt;=tr[o].l&amp;&amp;tr[o].r&lt;=r)&#123;
            tr[o].sum+=tr[o].sz*v;
            tr[o].tags+=v;
            <span class="hljs-keyword">return</span> ;
        &#125;
        push_down(o);
        <span class="hljs-keyword">int</span> mid=(tr[o].l+tr[o].r)&gt;&gt;<span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span>(l&lt;=mid) update_add(lson,l,r,v);
        <span class="hljs-keyword">if</span>(r&gt;mid) update_add(rson,l,r,v);
        push_up(o);
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">ask_sum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> o, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span></span>&#123;
        <span class="hljs-keyword">if</span>(l&lt;=tr[o].l&amp;&amp;tr[o].r&lt;=r)&#123;
            <span class="hljs-keyword">return</span> tr[o].sum%p;
        &#125;
        push_down(o);
        <span class="hljs-keyword">int</span> mid=(tr[o].l+tr[o].r)&gt;&gt;<span class="hljs-number">1</span>;
        <span class="hljs-keyword">int</span> ans=<span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span>(l&lt;=mid) ans=(ans+ask_sum(lson,l,r))%p;
        <span class="hljs-keyword">if</span>(r&gt;mid) ans=(ans+ask_sum(rson,l,r))%p;
        <span class="hljs-keyword">return</span> ans; 
    &#125;
    <span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> lson</span>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> rson</span>
&#125;seg;

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Modify</span>&#123;</span>
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">query_sum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>&#123;
        <span class="hljs-keyword">int</span> ans=<span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span>(sub.top[x]!=sub.top[y])&#123;
            <span class="hljs-keyword">if</span>(sub.dep[sub.top[x]]&lt;sub.dep[sub.top[y]]) swap(x,y);
            ans=(ans+seg.ask_sum(<span class="hljs-number">1</span>,sub.idx[sub.top[x]],sub.idx[x]))%p;
            x=sub.fa[sub.top[x]];
        &#125;
        <span class="hljs-keyword">if</span>(sub.dep[x]&gt;sub.dep[y]) swap(x,y);
        ans=(ans+seg.ask_sum(<span class="hljs-number">1</span>,sub.idx[x],sub.idx[y]))%p;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, ans%p);
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">modify_reg</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y,<span class="hljs-keyword">int</span> v)</span></span>&#123;
        <span class="hljs-keyword">while</span>(sub.top[x]!=sub.top[y])&#123;
            <span class="hljs-keyword">if</span>(sub.dep[sub.top[x]]&lt;sub.dep[sub.top[y]]) swap(x,y);
            seg.update_add(<span class="hljs-number">1</span>,sub.idx[sub.top[x]],sub.idx[x],v);
            x=sub.fa[sub.top[x]];
        &#125;
        <span class="hljs-keyword">if</span>(sub.dep[x]&gt;sub.dep[y]) swap(x,y);
        seg.update_add(<span class="hljs-number">1</span>,sub.idx[x],sub.idx[y],v);
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">modify_sontree</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> v)</span></span>&#123;
        seg.update_add(<span class="hljs-number">1</span>,sub.idx[x],sub.idx[x]+sub.tot[x]<span class="hljs-number">-1</span>,v);
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">query_sontree</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;
    	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, seg.ask_sum(<span class="hljs-number">1</span>,sub.idx[x],sub.idx[x]+sub.tot[x]<span class="hljs-number">-1</span>)%p);
    &#125;
&#125;modify;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">memset</span>(head,<span class="hljs-number">0</span>,<span class="hljs-keyword">sizeof</span>(head));
    n=read(),m=read(),r=read(),p=read();
    rep(i,<span class="hljs-number">1</span>,n) b[i]=read();
    rep(i,<span class="hljs-number">1</span>,n<span class="hljs-number">-1</span>)&#123;
        <span class="hljs-keyword">int</span> x=read(), y=read();
        ins(x,y);
    &#125;
    sub.dfs1(r,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);
    sub.dfs2(r,r);
    seg.build(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n);
    rep(i,<span class="hljs-number">1</span>,m)&#123;
        <span class="hljs-keyword">int</span> opt=read(),x,y,z;
        <span class="hljs-keyword">if</span>(opt==<span class="hljs-number">1</span>)&#123;
            x=read(),y=read(),z=read()%p;
            modify.modify_reg(x,y,z);
        &#125;
        <span class="hljs-keyword">if</span>(opt==<span class="hljs-number">2</span>)&#123;
            x=read(),y=read();
            modify.query_sum(x,y);
        &#125;
        <span class="hljs-keyword">if</span>(opt==<span class="hljs-number">3</span>)&#123;
            x=read(),z=read()%p;
            modify.modify_sontree(x,z);
        &#125;
        <span class="hljs-keyword">if</span>(opt==<span class="hljs-number">4</span>)&#123;
            x=read();
            modify.query_sontree(x);
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="数据结构"><a class="markdownIt-Anchor" href="#数据结构"></a> 数据结构</h3>
<h4 id="树状数组"><a class="markdownIt-Anchor" href="#树状数组"></a> 树状数组</h4>
<p>//真的不想写了…</p>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-keyword">int</span> n,m;
<span class="hljs-keyword">int</span> tree[<span class="hljs-number">2000010</span>];
<span class="hljs-keyword">int</span> a,b,c,d;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lowbit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;
    <span class="hljs-keyword">return</span> x &amp; -x;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> k)</span></span>&#123;<span class="hljs-comment">//单点+</span>
    <span class="hljs-keyword">while</span>(x&lt;=n)&#123;
        tree[x] += k;
        x += lowbit(x);
    &#125;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">sum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;
    <span class="hljs-keyword">int</span> ans=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span>(x&gt;<span class="hljs-number">0</span>)&#123;
        ans += tree[x];
        x -= lowbit(x);
    &#125;
    <span class="hljs-keyword">return</span> ans;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;m;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)&#123;
        <span class="hljs-built_in">cin</span>&gt;&gt;a;
        add(i,a);   
    &#125;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; ++i)&#123;
        <span class="hljs-built_in">cin</span>&gt;&gt;b&gt;&gt;c&gt;&gt;d;
        <span class="hljs-keyword">if</span>(b==<span class="hljs-number">1</span>)&#123;
            add(c,d);
        &#125;
        <span class="hljs-keyword">if</span>(b==<span class="hljs-number">2</span>)&#123;
            <span class="hljs-built_in">cout</span>&lt;&lt;sum(d)-sum(c<span class="hljs-number">-1</span>)&lt;&lt;<span class="hljs-built_in">endl</span>;
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;time.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rep(i,l,r) for(int i=l;i&lt;=r;++i)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rpe(i,r,l) for(int i=r;i&gt;=l;--i)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> pts puts(<span class="hljs-meta-string">""</span>)</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ull;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> node=<span class="hljs-number">500010</span>;
<span class="hljs-keyword">int</span> tree[node], n, m, in[node];

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lowbit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;<span class="hljs-keyword">return</span> x &amp;-x;&#125;
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> v)</span></span>&#123;<span class="hljs-keyword">while</span>(x&lt;=n)&#123;tree[x]+=v;x+=lowbit(x);&#125;&#125;<span class="hljs-comment">//区间+</span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;<span class="hljs-keyword">int</span> ans=<span class="hljs-number">0</span>;<span class="hljs-keyword">while</span>(x!=<span class="hljs-number">0</span>)&#123;ans+=tree[x];x-=lowbit(x);&#125;<span class="hljs-keyword">return</span> ans;&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    ios::sync_with_stdio(<span class="hljs-literal">false</span>);
    <span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;m;
    rep(i,<span class="hljs-number">1</span>,n) <span class="hljs-built_in">cin</span>&gt;&gt;in[i];
    rep(i,<span class="hljs-number">1</span>,m)&#123;
    	<span class="hljs-keyword">int</span> t,x,y,z;
    	<span class="hljs-built_in">cin</span>&gt;&gt;t;
    	<span class="hljs-keyword">if</span>(t==<span class="hljs-number">1</span>)&#123;
    		<span class="hljs-built_in">cin</span>&gt;&gt;x&gt;&gt;y&gt;&gt;z;
    		add(x,z);
    		add(y+<span class="hljs-number">1</span>,-z);
        &#125; <span class="hljs-keyword">else</span>&#123;
            <span class="hljs-built_in">cin</span>&gt;&gt;x;
            <span class="hljs-built_in">cout</span>&lt;&lt;in[x]+query(x)&lt;&lt;<span class="hljs-built_in">endl</span>;
        &#125;
    &#125;
&#125;</code></pre>
<h4 id="线段树"><a class="markdownIt-Anchor" href="#线段树"></a> 线段树</h4>
<h5 id="简单的线段树"><a class="markdownIt-Anchor" href="#简单的线段树"></a> 简单的线段树</h5>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LL long long</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAX = <span class="hljs-number">110000</span>;
<span class="hljs-keyword">int</span> N, M, Q;
LL sum[<span class="hljs-number">500000</span>], add[<span class="hljs-number">500000</span>];
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">read</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
	<span class="hljs-keyword">int</span> X = <span class="hljs-number">0</span>, w = <span class="hljs-number">1</span>; <span class="hljs-keyword">char</span> ch = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">while</span> (ch&lt;<span class="hljs-string">'0'</span> || ch&gt;<span class="hljs-string">'9'</span>) &#123; <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">'-'</span>) w = <span class="hljs-number">-1</span>; ch = getchar(); &#125;
	<span class="hljs-keyword">while</span> (ch &gt;= <span class="hljs-string">'0'</span> &amp;&amp; ch &lt;= <span class="hljs-string">'9'</span>) X = (X &lt;&lt; <span class="hljs-number">3</span>) + (X &lt;&lt; <span class="hljs-number">1</span>) + ch - <span class="hljs-string">'0'</span>, ch = getchar();
	<span class="hljs-keyword">return</span> X * w;
&#125;<span class="hljs-comment">//读入优化</span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">write</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> x)</span></span>
<span class="hljs-function"></span>&#123;
	<span class="hljs-keyword">if</span> (x&lt;<span class="hljs-number">0</span>) <span class="hljs-built_in">putchar</span>(<span class="hljs-string">'-'</span>), x = -x;
	<span class="hljs-keyword">if</span> (x&gt;<span class="hljs-number">9</span>) write(x / <span class="hljs-number">10</span>);
	<span class="hljs-built_in">putchar</span>(x % <span class="hljs-number">10</span> + <span class="hljs-string">'0'</span>);
&#125;<span class="hljs-comment">//输出优化</span>

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push_up</span><span class="hljs-params">(<span class="hljs-keyword">int</span> p)</span> </span>&#123;
	sum[p] = sum[p * <span class="hljs-number">2</span>] + sum[p * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>];
&#125;<span class="hljs-comment">//向上维护线段树</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span> root, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span></span>
<span class="hljs-function"></span>&#123;
	add[root] = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">if</span> (l == r)
		sum[root] = read();
	<span class="hljs-keyword">else</span>
	&#123;
		<span class="hljs-keyword">int</span> k = (l + r) &gt;&gt; <span class="hljs-number">1</span>;
		build(<span class="hljs-number">2</span> * root, l, k);
		build(<span class="hljs-number">2</span> * root + <span class="hljs-number">1</span>, k + <span class="hljs-number">1</span>, r);
		push_up(root);
	&#125;
&#125;<span class="hljs-comment">//建树</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-keyword">int</span> root, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span></span>
<span class="hljs-function"></span>&#123;
	<span class="hljs-keyword">if</span> (add[root])
	&#123;
		<span class="hljs-keyword">int</span> s1 = <span class="hljs-number">2</span> * root, s2 = <span class="hljs-number">2</span> * root + <span class="hljs-number">1</span>, k = (l + r) &gt;&gt; <span class="hljs-number">1</span>;
		add[s1] += add[root];
		add[s2] += add[root];
		sum[s1] += add[root] * (k - l + <span class="hljs-number">1</span>);
		sum[s2] += add[root] * (r - k);
		add[root] = <span class="hljs-number">0</span>;
	&#125;
&#125;<span class="hljs-comment">//向下维护线段树</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-keyword">int</span> nl, <span class="hljs-keyword">int</span> nr, <span class="hljs-keyword">int</span> c, <span class="hljs-keyword">int</span> root, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span><span class="hljs-comment">//访问区间 增加值 节点位置（或者用pos更好？） 原区间</span></span>
<span class="hljs-function"></span>&#123;
	<span class="hljs-keyword">if</span> (nl &lt;= l &amp;&amp; r &lt;= nr)<span class="hljs-comment">//访问区间直接包含原区间</span>
	&#123;
		add[root] += c;
		sum[root] += c * (r - l + <span class="hljs-number">1</span>);
		<span class="hljs-keyword">return</span>;
	&#125;
	pushdown(root, l, r);
	<span class="hljs-keyword">int</span> k = (l + r) &gt;&gt; <span class="hljs-number">1</span>;
	<span class="hljs-keyword">if</span> (nl &lt;= k) update(nl, nr, c, <span class="hljs-number">2</span> * root, l, k);<span class="hljs-comment">//左边</span>
	<span class="hljs-keyword">if</span> (nr &gt;= k + <span class="hljs-number">1</span>) update(nl, nr, c, <span class="hljs-number">2</span> * root + <span class="hljs-number">1</span>, k + <span class="hljs-number">1</span>, r);<span class="hljs-comment">//右边</span>
	push_up(root);
&#125;

<span class="hljs-function">LL <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> nl, <span class="hljs-keyword">int</span> nr, <span class="hljs-keyword">int</span> root, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span><span class="hljs-comment">//原理与上方区间增加值一样</span></span>
<span class="hljs-function"></span>&#123;
	<span class="hljs-keyword">if</span> (nl &lt;= l &amp;&amp; r &lt;= nr) <span class="hljs-comment">//同样，访问区间直接包含原区间，直接输出</span>
			<span class="hljs-keyword">return</span> sum[root];
	pushdown(root, l, r);
	<span class="hljs-keyword">int</span> k = (l + r) &gt;&gt; <span class="hljs-number">1</span>;
	LL ans = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">if</span> (nl &lt;= k) ans += query(nl, nr, <span class="hljs-number">2</span> * root, l, k);
	<span class="hljs-keyword">if</span> (nr &gt;= k + <span class="hljs-number">1</span>) ans += query(nl, nr, <span class="hljs-number">2</span> * root + <span class="hljs-number">1</span>, k + <span class="hljs-number">1</span>, r);
	<span class="hljs-keyword">return</span> ans;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
	N = read(), M = read();
	build(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, N);
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= M; i++)
	&#123;
		<span class="hljs-keyword">int</span> L, R, C;
		Q = read();
		<span class="hljs-keyword">if</span> (Q == <span class="hljs-number">1</span>)
		&#123;
			L = read(), R = read(), C = read();
			update(L, R, C, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, N);
		&#125;
		<span class="hljs-keyword">if</span> (Q == <span class="hljs-number">2</span>)
		&#123;
			L = read(), R = read();
			write(query(L, R, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, N));
			<span class="hljs-built_in">putchar</span>(<span class="hljs-string">'\n'</span>);
		&#125;
	&#125;
	<span class="hljs-comment">//system("pause");</span>
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;;
&#125;</code></pre>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> p;
<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a[<span class="hljs-number">100007</span>];
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span>&#123;</span>
    <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> v, mul, add;
&#125;node[<span class="hljs-number">400007</span>];

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bt</span><span class="hljs-params">(<span class="hljs-keyword">int</span> root, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span></span>&#123;
    node[root].mul=<span class="hljs-number">1</span>;
    node[root].add=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span>(l==r)&#123;
        node[root].v=a[l];
    &#125;
    <span class="hljs-keyword">else</span>&#123;
        <span class="hljs-keyword">int</span> m=(l+r)/<span class="hljs-number">2</span>;
        bt(root*<span class="hljs-number">2</span>, l, m);
        bt(root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>, m+<span class="hljs-number">1</span>, r);
        node[root].v=node[root*<span class="hljs-number">2</span>].v+node[root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>].v;
    &#125;
    node[root].v%=p;
    <span class="hljs-keyword">return</span> ;
&#125;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-keyword">int</span> root, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span></span>&#123;
    <span class="hljs-keyword">int</span> m=(l+r)/<span class="hljs-number">2</span>;
    node[root*<span class="hljs-number">2</span>].v=(node[root*<span class="hljs-number">2</span>].v*node[root].mul+node[root].add*(m-l+<span class="hljs-number">1</span>))%p;
    node[root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>].v=(node[root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>].v*node[root].mul+node[root].add*(r-m))%p;
    node[root*<span class="hljs-number">2</span>].mul=(node[root*<span class="hljs-number">2</span>].mul*node[root].mul)%p;
    node[root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>].mul=(node[root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>].mul*node[root].mul)%p;
    node[root*<span class="hljs-number">2</span>].add=(node[root*<span class="hljs-number">2</span>].add*node[root].mul+node[root].add)%p;
    node[root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>].add=(node[root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>].add*node[root].mul+node[root].add)%p;
    node[root].mul=<span class="hljs-number">1</span>;
    node[root].add=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> ;
&#125;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ud1</span><span class="hljs-params">(<span class="hljs-keyword">int</span> root, <span class="hljs-keyword">int</span> nodedl, <span class="hljs-keyword">int</span> nodedr, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> k)</span></span>&#123;
    <span class="hljs-keyword">if</span>(r&lt;nodedl || nodedr&lt;l)&#123;
        <span class="hljs-keyword">return</span> ;
    &#125;
    <span class="hljs-keyword">if</span>(l&lt;=nodedl &amp;&amp; nodedr&lt;=r)&#123;
        node[root].v=(node[root].v*k)%p;
        node[root].mul=(node[root].mul*k)%p;
        node[root].add=(node[root].add*k)%p;
        <span class="hljs-keyword">return</span> ;
    &#125;
    pushdown(root, nodedl, nodedr);
    <span class="hljs-keyword">int</span> m=(nodedl+nodedr)/<span class="hljs-number">2</span>;
    ud1(root*<span class="hljs-number">2</span>, nodedl, m, l, r, k);
    ud1(root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>, m+<span class="hljs-number">1</span>, nodedr, l, r, k);
    node[root].v=(node[root*<span class="hljs-number">2</span>].v+node[root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>].v)%p;
    <span class="hljs-keyword">return</span> ;
&#125;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ud2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> root, <span class="hljs-keyword">int</span> nodedl, <span class="hljs-keyword">int</span> nodedr, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> k)</span></span>&#123;
    <span class="hljs-keyword">if</span>(r&lt;nodedl || nodedr&lt;l)&#123;
        <span class="hljs-keyword">return</span> ;
    &#125;
    <span class="hljs-keyword">if</span>(l&lt;=nodedl &amp;&amp; nodedr&lt;=r)&#123;
        node[root].add=(node[root].add+k)%p;
        node[root].v=(node[root].v+k*(nodedr-nodedl+<span class="hljs-number">1</span>))%p;
        <span class="hljs-keyword">return</span> ;
    &#125;
    pushdown(root, nodedl, nodedr);
    <span class="hljs-keyword">int</span> m=(nodedl+nodedr)/<span class="hljs-number">2</span>;
    ud2(root*<span class="hljs-number">2</span>, nodedl, m, l, r, k);
    ud2(root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>, m+<span class="hljs-number">1</span>, nodedr, l, r, k);
    node[root].v=(node[root*<span class="hljs-number">2</span>].v+node[root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>].v)%p;
    <span class="hljs-keyword">return</span> ;
&#125;

<span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> root, <span class="hljs-keyword">int</span> nodedl, <span class="hljs-keyword">int</span> nodedr, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span></span>&#123;
    <span class="hljs-keyword">if</span>(r&lt;nodedl || nodedr&lt;l)&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    &#125;
    <span class="hljs-keyword">if</span>(l&lt;=nodedl &amp;&amp; nodedr&lt;=r)&#123;
        <span class="hljs-keyword">return</span> node[root].v;
    &#125;
    pushdown(root, nodedl, nodedr);
    <span class="hljs-keyword">int</span> m=(nodedl+nodedr)/<span class="hljs-number">2</span>;
    <span class="hljs-keyword">return</span> (query(root*<span class="hljs-number">2</span>, nodedl, m, l, r)+query(root*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>, m+<span class="hljs-number">1</span>, nodedr, l, r))%p;
&#125;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-keyword">int</span> n, m;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;p);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>; i&lt;=n; i++)&#123;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%lld"</span>, &amp;a[i]);
    &#125;
    bt(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n);
    <span class="hljs-keyword">while</span>(m--)&#123;
        <span class="hljs-keyword">int</span> chk;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;chk);
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> k;
        <span class="hljs-keyword">if</span>(chk==<span class="hljs-number">1</span>)&#123;
            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%lld"</span>, &amp;x, &amp;y, &amp;k);
            ud1(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, x, y, k);
        &#125;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(chk==<span class="hljs-number">2</span>)&#123;
            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%lld"</span>, &amp;x, &amp;y, &amp;k);
            ud2(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, x, y, k);
        &#125;
        <span class="hljs-keyword">else</span>&#123;
            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;x, &amp;y);
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld\n"</span>, query(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, x, y));
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h4 id="标记永久化线段树"><a class="markdownIt-Anchor" href="#标记永久化线段树"></a> 标记永久化线段树</h4>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> pos(i,a,b) for(int i=(a);i&lt;=(b);i++)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> N 201000</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> n,m;
<span class="hljs-keyword">int</span> sum[N*<span class="hljs-number">4</span>],add[N*<span class="hljs-number">4</span>];
<span class="hljs-keyword">int</span> a[N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l,<span class="hljs-keyword">int</span> r,<span class="hljs-keyword">int</span> rt)</span></span>&#123;
    <span class="hljs-keyword">if</span>(l==r)&#123;
        sum[rt]=a[l];<span class="hljs-keyword">return</span>;
    &#125;
    <span class="hljs-keyword">int</span> mid=(l+r)&gt;&gt;<span class="hljs-number">1</span>;
    build(l,mid,rt&lt;&lt;<span class="hljs-number">1</span>);
    build(mid+<span class="hljs-number">1</span>,r,rt&lt;&lt;<span class="hljs-number">1</span>|<span class="hljs-number">1</span>);
    sum[rt]=sum[rt&lt;&lt;<span class="hljs-number">1</span>]+sum[rt&lt;&lt;<span class="hljs-number">1</span>|<span class="hljs-number">1</span>];
&#125;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-keyword">int</span> rt,<span class="hljs-keyword">int</span> l,<span class="hljs-keyword">int</span> r,<span class="hljs-keyword">int</span> v,<span class="hljs-keyword">int</span> xl,<span class="hljs-keyword">int</span> xr)</span></span>&#123;
    sum[rt]+=v*(xr-xl+<span class="hljs-number">1</span>);
    <span class="hljs-keyword">if</span>(l==xl&amp;&amp;r==xr)&#123;
        add[rt]+=v; <span class="hljs-keyword">return</span>;
    &#125;
    <span class="hljs-keyword">int</span> mid=(l+r)&gt;&gt;<span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span>(xr&lt;=mid)  update(rt&lt;&lt;<span class="hljs-number">1</span>,l,mid,v,xl,xr);
    <span class="hljs-keyword">else</span>&#123;
        <span class="hljs-keyword">if</span>(xl&gt;mid)   update(rt&lt;&lt;<span class="hljs-number">1</span>|<span class="hljs-number">1</span>,mid+<span class="hljs-number">1</span>,r,v,xl,xr);
        <span class="hljs-keyword">else</span> update(rt&lt;&lt;<span class="hljs-number">1</span>,l,mid,v,xl,mid),update(rt&lt;&lt;<span class="hljs-number">1</span>|<span class="hljs-number">1</span>,mid+<span class="hljs-number">1</span>,r,v,mid+<span class="hljs-number">1</span>,xr);
    &#125;
&#125;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> rt,<span class="hljs-keyword">int</span> ad,<span class="hljs-keyword">int</span> l,<span class="hljs-keyword">int</span> r,<span class="hljs-keyword">int</span> xl,<span class="hljs-keyword">int</span> xr)</span></span>&#123;
    <span class="hljs-keyword">if</span>(xl==l&amp;&amp;xr==r)&#123;
        <span class="hljs-keyword">return</span> sum[rt]+ad*(xr-xl+<span class="hljs-number">1</span>);
    &#125;  
    <span class="hljs-keyword">int</span> mid=(l+r)&gt;&gt;<span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span>(xr&lt;=mid) <span class="hljs-keyword">return</span> query(rt&lt;&lt;<span class="hljs-number">1</span>,ad+add[rt],l,mid,xl,xr);
    <span class="hljs-keyword">else</span>&#123;
        <span class="hljs-keyword">if</span>(xl&gt;mid) <span class="hljs-keyword">return</span> query(rt&lt;&lt;<span class="hljs-number">1</span>|<span class="hljs-number">1</span>,ad+add[rt],mid+<span class="hljs-number">1</span>,r,xl,xr);
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> query(rt&lt;&lt;<span class="hljs-number">1</span>,ad+add[rt],l,mid,xl,mid)+query(rt&lt;&lt;<span class="hljs-number">1</span>|<span class="hljs-number">1</span>,ad+add[rt],mid+<span class="hljs-number">1</span>,r,mid+<span class="hljs-number">1</span>,xr);
    &#125;
&#125;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>,&amp;n,&amp;m);
    pos(i,<span class="hljs-number">1</span>,n) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>,&amp;a[i]);
    build(<span class="hljs-number">1</span>,n,<span class="hljs-number">1</span>);
    pos(i,<span class="hljs-number">1</span>,m)&#123;
        <span class="hljs-keyword">int</span> opt;<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>,&amp;opt);
        <span class="hljs-keyword">int</span> x,y;<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>,&amp;x,&amp;y);
        <span class="hljs-keyword">if</span>(opt==<span class="hljs-number">1</span>)&#123;
            <span class="hljs-keyword">int</span> k;<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>,&amp;k);
            update(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n,k,x,y);
        &#125;
        <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>,query(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,n,x,y));
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
<span class="hljs-comment">//转载自Hallmeow</span></code></pre>
<h4 id="可持续化线段树"><a class="markdownIt-Anchor" href="#可持续化线段树"></a> 可持续化线段树</h4>
<p>不会</p>
<h4 id="动态加点线段树"><a class="markdownIt-Anchor" href="#动态加点线段树"></a> 动态加点线段树</h4>
<pre><code class="hljs cpp"><span class="hljs-comment">//CF915E Physical Education Lessons</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rr register</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">500007</span> * <span class="hljs-number">30</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> inf = <span class="hljs-number">0x7f7f7f7f</span>;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">read</span><span class="hljs-params">()</span> </span>&#123;
    rr <span class="hljs-keyword">int</span> g = <span class="hljs-number">1</span>, x = <span class="hljs-number">0</span>;
    rr <span class="hljs-keyword">char</span> ch = getchar();
    <span class="hljs-keyword">while</span>(ch &lt; <span class="hljs-string">'0'</span> || ch &gt; <span class="hljs-string">'9'</span>) &#123;<span class="hljs-keyword">if</span>(ch == <span class="hljs-string">'-'</span>) g = <span class="hljs-number">-1</span>; ch = getchar();&#125;
    <span class="hljs-keyword">while</span>(ch &gt;= <span class="hljs-string">'0'</span> &amp;&amp; ch &lt;= <span class="hljs-string">'9'</span>) &#123;x = (((x &lt;&lt; <span class="hljs-number">2</span>) + x) &lt;&lt; <span class="hljs-number">1</span>) + (ch ^ <span class="hljs-string">'0'</span>); ch = getchar();&#125;
    <span class="hljs-keyword">return</span> x * g;
&#125;

<span class="hljs-keyword">int</span> n, q;
<span class="hljs-keyword">int</span> sum[maxn], tags[maxn], rs[maxn], ls[maxn], id = <span class="hljs-number">0</span>, rt = <span class="hljs-number">0</span>;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-keyword">int</span> o, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>&#123;
    <span class="hljs-keyword">if</span>(tags[o] == <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> ;
    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span>(l != r) &#123;
        <span class="hljs-keyword">if</span>(!ls[o]) ls[o] = ++id;
        <span class="hljs-keyword">if</span>(!rs[o]) rs[o] = ++id;
        sum[ls[o]] = tags[o] * (mid - l + <span class="hljs-number">1</span>);
        sum[rs[o]] = tags[o] * (r - mid); 
        tags[ls[o]] = tags[o];
        tags[rs[o]] = tags[o];
    &#125;
    tags[o] = <span class="hljs-number">-1</span>;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-keyword">int</span> &amp;o, <span class="hljs-keyword">int</span> ql, <span class="hljs-keyword">int</span> qr, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> v)</span> </span>&#123;
    <span class="hljs-keyword">if</span>(!o) o = ++id;
    <span class="hljs-keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) &#123;
        sum[o] = v * (r - l + <span class="hljs-number">1</span>);
        tags[o] = v;
        <span class="hljs-keyword">return</span> ;
    &#125;
    pushdown(o, l, r);
    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span>(ql &lt;= mid) update(ls[o], ql, qr, l, mid, v);
    <span class="hljs-keyword">if</span>(qr &gt; mid) update(rs[o], ql, qr, mid + <span class="hljs-number">1</span>, r, v);
    sum[o] = sum[ls[o]] + sum[rs[o]];
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-built_in">memset</span>(tags, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span>(tags));
    n = read(), q = read();
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= q; ++i) &#123;
        <span class="hljs-keyword">int</span> l = read(), r = read(), k = read();
        <span class="hljs-keyword">if</span>(k == <span class="hljs-number">1</span>) update(rt, l, r, <span class="hljs-number">1</span>, n, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">else</span> update(rt, l, r, <span class="hljs-number">1</span>, n, <span class="hljs-number">0</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, n - sum[<span class="hljs-number">1</span>]);
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h4 id="左偏树"><a class="markdownIt-Anchor" href="#左偏树"></a> 左偏树</h4>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> max_ = <span class="hljs-number">100010</span>;

<span class="hljs-keyword">int</span> n, m;
<span class="hljs-keyword">int</span> ch[max_][<span class="hljs-number">2</span>];<span class="hljs-comment">//表示当前节点儿子的编号</span>
<span class="hljs-keyword">int</span> a[max_], dis[max_]<span class="hljs-comment">/*树上距离*/</span>, f[max_]<span class="hljs-comment">/*父亲节点编号*/</span>;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>&#123;
    <span class="hljs-keyword">if</span>(!x||!y) <span class="hljs-keyword">return</span> x|y;
    <span class="hljs-keyword">if</span>(a[x]&gt;a[y]||(a[x]==a[y]&amp;&amp;x&gt;y)) swap(x,y);<span class="hljs-comment">//小根堆</span>
    ch[x][<span class="hljs-number">1</span>]=merge(ch[x][<span class="hljs-number">1</span>],y);
    f[ch[x][<span class="hljs-number">1</span>]]=x;
    <span class="hljs-keyword">if</span>(dis[ch[x][<span class="hljs-number">0</span>]]&lt;dis[ch[x][<span class="hljs-number">1</span>]]) swap(ch[x][<span class="hljs-number">0</span>], ch[x][<span class="hljs-number">1</span>]);<span class="hljs-comment">//左偏树</span>
    dis[x]=dis[ch[x][<span class="hljs-number">1</span>]]+<span class="hljs-number">1</span>;<span class="hljs-comment">//左偏树的距离</span>
    <span class="hljs-keyword">return</span> x;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getfa</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;
    <span class="hljs-keyword">while</span>(f[x]<span class="hljs-comment">/*仍然存在父亲节点*/</span>) x=f[x];
    <span class="hljs-keyword">return</span> x;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">del</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;
    a[x]=<span class="hljs-number">-1</span>;
    f[ch[x][<span class="hljs-number">0</span>]]=f[ch[x][<span class="hljs-number">1</span>]]=<span class="hljs-number">0</span>;
    merge(ch[x][<span class="hljs-number">0</span>],ch[x][<span class="hljs-number">1</span>]);
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d %d"</span>, &amp;n, &amp;m);
    dis[<span class="hljs-number">0</span>]=<span class="hljs-number">-1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;a[i]);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; ++i)&#123;
        <span class="hljs-keyword">int</span> k;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;k);
        <span class="hljs-keyword">if</span>(k==<span class="hljs-number">1</span>)&#123;
            <span class="hljs-keyword">int</span> x, y;
            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d %d"</span>, &amp;x, &amp;y);
            <span class="hljs-keyword">if</span>(a[x]==<span class="hljs-number">-1</span>||a[y]==<span class="hljs-number">-1</span>) <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">if</span>(x==y) <span class="hljs-keyword">continue</span>;
            merge(getfa(x),getfa(y));
        &#125;
        <span class="hljs-keyword">else</span> &#123;
            <span class="hljs-keyword">int</span> x;
            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;x);
            <span class="hljs-keyword">if</span>(a[x]==<span class="hljs-number">-1</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">"-1\n"</span>);
            <span class="hljs-keyword">else</span>&#123;
                <span class="hljs-keyword">int</span> now=getfa(x);
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, a[now]);
                del(now);
            &#125;
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<h3 id="不知道什么东西"><a class="markdownIt-Anchor" href="#不知道什么东西"></a> 不知道什么东西</h3>
<pre><code class="hljs cpp"><span class="hljs-comment">//hdu2089 数位DP入门题</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">10001</span>;

<span class="hljs-keyword">int</span> a[maxn];
<span class="hljs-keyword">int</span> dp[maxn][<span class="hljs-number">2</span>];

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> pos, <span class="hljs-keyword">int</span> pre, <span class="hljs-keyword">int</span> sta, <span class="hljs-keyword">bool</span> limit)</span> </span>&#123;
	<span class="hljs-keyword">if</span>(pos == <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
	<span class="hljs-keyword">if</span>(!limit &amp;&amp; dp[pos][sta] != <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> dp[pos][sta];
	<span class="hljs-keyword">int</span> up = limit ? a[pos] : <span class="hljs-number">9</span>;
	<span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= up; ++i) &#123;
		<span class="hljs-keyword">if</span>(pre == <span class="hljs-number">6</span> &amp;&amp; i == <span class="hljs-number">2</span>) <span class="hljs-keyword">continue</span>;
		<span class="hljs-keyword">if</span>(i == <span class="hljs-number">4</span>) <span class="hljs-keyword">continue</span>;
		res += dfs(pos - <span class="hljs-number">1</span>, i, i == <span class="hljs-number">6</span>, limit &amp;&amp; i == a[pos]);
	&#125;
	<span class="hljs-keyword">if</span>(!limit) dp[pos][sta] = res;
	<span class="hljs-keyword">return</span> res;
&#125;

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">solve</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;
	<span class="hljs-keyword">int</span> pos = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">while</span>(x) &#123;
		a[pos++] = x % <span class="hljs-number">10</span>;
		x /= <span class="hljs-number">10</span>;
	&#125;
	<span class="hljs-keyword">return</span> dfs(pos - <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">true</span>);
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;
	<span class="hljs-keyword">int</span> l, r;
	<span class="hljs-built_in">memset</span>(dp, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span>(dp));
	<span class="hljs-keyword">while</span>(<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d %d"</span>, &amp;l, &amp;r)) &#123;
		<span class="hljs-keyword">if</span>(!l &amp;&amp; !r) <span class="hljs-keyword">break</span>;
		<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, solve(r) - solve(l - <span class="hljs-number">1</span>));
	&#125;
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<p>高精度&lt;重载运算符&gt;</p>
<pre><code class="hljs cpp"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAXN = <span class="hljs-number">410</span>;  

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BigNum</span>  </span>
<span class="hljs-class">&#123;</span>  
    <span class="hljs-keyword">int</span> len, s[MAXN];  
    BigNum ()  
    &#123;  
        <span class="hljs-built_in">memset</span>(s, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(s));  
        len = <span class="hljs-number">1</span>;  
    &#125;  
    BigNum (<span class="hljs-keyword">int</span> num) &#123; *<span class="hljs-keyword">this</span> = num; &#125;  
    BigNum (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *num) &#123; *<span class="hljs-keyword">this</span> = num; &#125;  
    BigNum <span class="hljs-keyword">operator</span> = (<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> num)  
    &#123;  
        <span class="hljs-keyword">char</span> s[MAXN];  
        <span class="hljs-built_in">sprintf</span>(s, <span class="hljs-string">"%d"</span>, num);  
        *<span class="hljs-keyword">this</span> = s;  
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> = (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *num)  
    &#123;  
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; num[i] == <span class="hljs-string">'0'</span>; num++) ;  <span class="hljs-comment">//去前导0  </span>
        len = <span class="hljs-built_in">strlen</span>(num);  
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) s[i] = num[len-i<span class="hljs-number">-1</span>] - <span class="hljs-string">'0'</span>;  
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> + (<span class="hljs-keyword">const</span> BigNum &amp;b) <span class="hljs-keyword">const</span> <span class="hljs-comment">//+  </span>
    &#123;  
        BigNum c;  
        c.len = <span class="hljs-number">0</span>;  
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, g = <span class="hljs-number">0</span>; g || i &lt; max(len, b.len); i++)  
        &#123;  
            <span class="hljs-keyword">int</span> x = g;  
            <span class="hljs-keyword">if</span>(i &lt; len) x += s[i];  
            <span class="hljs-keyword">if</span>(i &lt; b.len) x += b.s[i];  
            c.s[c.len++] = x % <span class="hljs-number">10</span>;  
            g = x / <span class="hljs-number">10</span>;  
        &#125;  
        <span class="hljs-keyword">return</span> c;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> += (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        *<span class="hljs-keyword">this</span> = *<span class="hljs-keyword">this</span> + b;  
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;  
    &#125;  
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">clean</span><span class="hljs-params">()</span>  </span>
<span class="hljs-function">    </span>&#123;  
        <span class="hljs-keyword">while</span>(len &gt; <span class="hljs-number">1</span> &amp;&amp; !s[len<span class="hljs-number">-1</span>]) len--;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> * (<span class="hljs-keyword">const</span> BigNum &amp;b) <span class="hljs-comment">//*  </span>
    &#123;  
        BigNum c;  
        c.len = len + b.len;  
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++)  
        &#123;  
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; b.len; j++)  
            &#123;  
                c.s[i+j] += s[i] * b.s[j];  
            &#125;  
        &#125;  
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; c.len; i++)  
        &#123;  
            c.s[i+<span class="hljs-number">1</span>] += c.s[i]/<span class="hljs-number">10</span>;  
            c.s[i] %= <span class="hljs-number">10</span>;  
        &#125;  
        c.clean();  
        <span class="hljs-keyword">return</span> c;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> *= (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        *<span class="hljs-keyword">this</span> = *<span class="hljs-keyword">this</span> * b;  
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> - (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        BigNum c;  
        c.len = <span class="hljs-number">0</span>;  
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, g = <span class="hljs-number">0</span>; i &lt; len; i++)  
        &#123;  
            <span class="hljs-keyword">int</span> x = s[i] - g;  
            <span class="hljs-keyword">if</span>(i &lt; b.len) x -= b.s[i];  
            <span class="hljs-keyword">if</span>(x &gt;= <span class="hljs-number">0</span>) g = <span class="hljs-number">0</span>;  
            <span class="hljs-keyword">else</span>  
            &#123;  
                g = <span class="hljs-number">1</span>;  
                x += <span class="hljs-number">10</span>;  
            &#125;  
            c.s[c.len++] = x;  
        &#125;  
        c.clean();  
        <span class="hljs-keyword">return</span> c;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> -= (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        *<span class="hljs-keyword">this</span> = *<span class="hljs-keyword">this</span> - b;  
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> / (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        BigNum c, f = <span class="hljs-number">0</span>;  
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = len<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; i--)  
        &#123;  
            f = f*<span class="hljs-number">10</span>;  
            f.s[<span class="hljs-number">0</span>] = s[i];  
            <span class="hljs-keyword">while</span>(f &gt;= b)  
            &#123;  
                f -= b;  
                c.s[i]++;  
            &#125;  
        &#125;  
        c.len = len;  
        c.clean();  
        <span class="hljs-keyword">return</span> c;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> /= (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        *<span class="hljs-keyword">this</span>  = *<span class="hljs-keyword">this</span> / b;  
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> % (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        BigNum r = *<span class="hljs-keyword">this</span> / b;  
        r = *<span class="hljs-keyword">this</span> - r*b;  
        <span class="hljs-keyword">return</span> r;  
    &#125;  
    BigNum <span class="hljs-keyword">operator</span> %= (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        *<span class="hljs-keyword">this</span> = *<span class="hljs-keyword">this</span> % b;  
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;  
    &#125;  
    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span> &lt; (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        <span class="hljs-keyword">if</span>(len != b.len) <span class="hljs-keyword">return</span> len &lt; b.len;  
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = len<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; i--)  
        &#123;  
            <span class="hljs-keyword">if</span>(s[i] != b.s[i]) <span class="hljs-keyword">return</span> s[i] &lt; b.s[i];  
        &#125;  
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  
    &#125;  
    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span> &gt; (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        <span class="hljs-keyword">if</span>(len != b.len) <span class="hljs-keyword">return</span> len &gt; b.len;  
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = len<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; i--)  
        &#123;  
            <span class="hljs-keyword">if</span>(s[i] != b.s[i]) <span class="hljs-keyword">return</span> s[i] &gt; b.s[i];  
        &#125;  
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  
    &#125;  
    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span> == (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        <span class="hljs-keyword">return</span> !(*<span class="hljs-keyword">this</span> &gt; b) &amp;&amp; !(*<span class="hljs-keyword">this</span> &lt; b);  
    &#125;  
    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span> != (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        <span class="hljs-keyword">return</span> !(*<span class="hljs-keyword">this</span> == b);  
    &#125;  
    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span> &lt;= (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span> &lt; b || *<span class="hljs-keyword">this</span> == b;  
    &#125;  
    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span> &gt;= (<span class="hljs-keyword">const</span> BigNum &amp;b)  
    &#123;  
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span> &gt; b || *<span class="hljs-keyword">this</span> == b;  
    &#125;  
    <span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">str</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span>  </span>
<span class="hljs-function">    </span>&#123;  
        <span class="hljs-built_in">string</span> res = <span class="hljs-string">""</span>;  
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) res = <span class="hljs-keyword">char</span>(s[i]+<span class="hljs-string">'0'</span>) + res;  
        <span class="hljs-keyword">return</span> res;  
    &#125;  
&#125;;  

istream&amp; <span class="hljs-keyword">operator</span> &gt;&gt; (istream &amp;in, BigNum &amp;x)  
&#123;  
    <span class="hljs-built_in">string</span> s;  
    in &gt;&gt; s;  
    x = s.c_str();  
    <span class="hljs-keyword">return</span> in;  
&#125;  

ostream&amp; <span class="hljs-keyword">operator</span> &lt;&lt; (ostream &amp;out, <span class="hljs-keyword">const</span> BigNum &amp;x)  
&#123;  
    out &lt;&lt; x.str();  
    <span class="hljs-keyword">return</span> out;  
&#125;</code></pre>
            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E4%BB%A3%E7%A0%81/">代码</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E9%A2%98%E8%A7%A3/">题解</a>
                    
                  </div>
                
              </div>
              
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "模板整理&nbsp;",
      ],
      cursorChar: "|",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>





  

  
    <!-- KaTeX -->
    <link  rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.css" />
  
















</body>
</html>
